<!doctype html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no">
    
    
    <!--Simple SEO-->

<meta name="description" content="程序员的梦工厂/">


<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">
    <!--Title-->

<title>Kubernetes 集群搭建 | 小小杰博客</title>

<link rel="alternate" href="/atom.xml" title="小小杰博客" type="application/atom+xml">


<link rel="icon" href="/favicon.ico">

    
<link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/css/pages/post.css">
<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/thirdParty/highlight/github.css">


    <!--script-->



<!--<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>-->



    
    
</head>
</html>
<body id="normal">
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<style>
    header{ top: 71px; position: absolute!important;}
    #container{padding-top: 151px!important;}
</style>
<div style="position:fixed;z-index:9999;left:0;top:0;width:100%;height:70px;background-color:#e0e0e0;color:#396CA5;border-bottom:1px solid #cecece;text-align:center;line-height:70px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<div id="wrap">
    <header style="position: absolute;">
    <div id="site-meta">
        <a href="/" id="logo">
            <h1 class="title">小小杰博客</h1>
        </a>
        
        <h2 class="subtitle">代码改变世界</h2>
        
    </div>
    <ul id="nav">
        
            <li><a href="/"><i class="fa fa-home"></i>首页</a></li>
        
            <li><a href="/2018/12/15/about/"><i class="fa fa-user"></i>关于我</a></li>
        
            <li><a href="/atom.xml"><i class="fa fa-rss"></i>RSS</a></li>
        
        <li id="search"><a href="javascript:void(0)"><i class="fa fa-search"></i>搜索</a></li>
    </ul>
</header>

    <div id="container">
        
<ul id="sidebar">
    
    
<li class="widget notification">
    <i class="fa fa-bell-o"></i>
    <div>
        
<p>学而时习之，不亦乐乎</p>
    </div>
</li>

    
    
<li class="widget widget-normal category">
    <h3 class="fa fa-th widget-title">分类</h3>
    <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/并发编程/"><i class="fa" aria-hidden="true">并发编程</i></a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/框架/"><i class="fa" aria-hidden="true">框架</i></a><span class="category-list-count">10</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/框架/Spring/"><i class="fa" aria-hidden="true">Spring</i></a><span class="category-list-count">10</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/消息中间件/"><i class="fa" aria-hidden="true">消息中间件</i></a><span class="category-list-count">5</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/消息中间件/Kafka/"><i class="fa" aria-hidden="true">Kafka</i></a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/消息中间件/RabbitMQ/"><i class="fa" aria-hidden="true">RabbitMQ</i></a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link current" href="/categories/物理部署/"><i class="fa" aria-hidden="true">物理部署</i></a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/"><i class="fa" aria-hidden="true">随笔</i></a><span class="category-list-count">5</span></li></ul>
</li>


    
    
<li class="widget widget-normal archive">
  <h3 class="fa fa-archive widget-title">时光轴</h3>
    <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/"><i class="fa" aria-hidden="true">六月 2020</i></a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/"><i class="fa" aria-hidden="true">四月 2020</i></a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/"><i class="fa" aria-hidden="true">七月 2019</i></a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/"><i class="fa" aria-hidden="true">六月 2019</i></a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/"><i class="fa" aria-hidden="true">三月 2019</i></a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/"><i class="fa" aria-hidden="true">二月 2019</i></a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/"><i class="fa" aria-hidden="true">十二月 2018</i></a><span class="archive-list-count">5</span></li></ul>
</li>


    
    

    
    
<li class="widget widget-normal tags">
  <h3 class="fa fa-tags widget-title">标签云</h3>
  <div class="tagcloud-content">
    
      <a href="/tags/类加载/" style="font-size: 0.14rem; color: #69c">类加载</a> <a href="/tags/docker/" style="font-size: 0.16rem; color: #4f83b8">docker</a> <a href="/tags/事务/" style="font-size: 0.14rem; color: #69c">事务</a> <a href="/tags/关于我/" style="font-size: 0.14rem; color: #69c">关于我</a> <a href="/tags/jvm/" style="font-size: 0.14rem; color: #69c">jvm</a> <a href="/tags/k8s/" style="font-size: 0.16rem; color: #4f83b8">k8s</a> <a href="/tags/索引/" style="font-size: 0.14rem; color: #69c">索引</a> <a href="/tags/Kafka/" style="font-size: 0.17rem; color: #386da4">Kafka</a> <a href="/tags/Maven/" style="font-size: 0.14rem; color: #69c">Maven</a> <a href="/tags/Spring/" style="font-size: 0.2rem; color: #0a407c">Spring</a> <a href="/tags/RabbitMQ/" style="font-size: 0.14rem; color: #69c">RabbitMQ</a> <a href="/tags/多线程/" style="font-size: 0.18rem; color: #215690">多线程</a>
  </div>
</li>


    
    
<li class="widget widget-normal friends-link">
    <h3 class="fa fa-globe widget-title">友情链接</h3><br>

    
        <a href="https://qkongtao.cn" class="fa" target="_blank">另一个世界</a>

    
        <a href="http://wuwenliang.net" class="fa" target="_blank">朝·闻·道</a>

    
        <a href="https://pleuvoir.github.io" class="fa" target="_blank">撄而后成</a>

    

</li>


    
</ul>


        <div id="main">
    <article id="post">
        <div id="post-header">

            <h1 id="Kubernetes 集群搭建">
                
                Kubernetes 集群搭建
                
            </h1>
            <div class="article-meta">
    
    
    <span class="categories-meta fa-wrap">
            <i class="fa fa-folder-open-o"></i>
        <span>物理部署</span>
    </span>
    
    
    <span class="fa-wrap">
         <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
            k8s
            
        </span>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-clock-o"></i>
        <span class="date-meta ">2020/06/20</span>
    </span>
    
    
    
</div>

            
            
            <p class="fa fa-exclamation-triangle warning">
                本文于<strong>886</strong>天之前发表，文中内容可能已经过时。如有疑问，请在评论区留言。
            </p>
            
        </div>
        
        <div id="post-body">
            <h2 id="1-1-环境准备"><a href="#1-1-环境准备" class="headerlink" title="1.1 环境准备"></a>1.1 环境准备</h2><p>本次教程，使用docker 18.09.9和kubelet-1.16.4，要求centos7.6以上版本</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvdlpy87j30ig020jrp.jpg" alt>                               </p>
<h3 id="1-1-1-关闭selinux"><a href="#1-1-1-关闭selinux" class="headerlink" title="1.1.1 关闭selinux"></a>1.1.1 关闭selinux</h3><p>查看selinux是否关闭</p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvg0j2d4j30hq01yaa7.jpg" alt></p>
<p>先设置临时关闭</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvg7256sj30i402owhm.jpg" alt="image-20200620171455330"> </p>
<p>永久关闭</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvgetzz7j30n205gn7d.jpg" alt="image-20200620171505161"></p>
<h3 id="1-1-2-关闭swap"><a href="#1-1-2-关闭swap" class="headerlink" title="1.1.2 关闭swap"></a>1.1.2 关闭swap</h3><p><strong>k8s</strong> <strong>要求系统关闭，否则安装过程会报错</strong></p>
<p><strong>查看系统是否关闭了swap</strong></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvgl1pomj30n2090wgz.jpg" alt></p>
<p><strong>临时禁用：swapoff -a</strong></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvgxptgyj30n206qgy6.jpg" alt="image-20200620171529524"> </p>
<p><strong>永久禁用：sed -i.bak ‘/swap/s/^/#/‘ /etc/fstab  ##</strong> <strong>注释掉swap</strong> <strong>那一行</strong></p>
<p><strong>作用就是修改/etc/fstab</strong> <strong>配置为如下：</strong></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvi8kvmbj30n2070jsk.jpg" alt> </p>
<h3 id="1-1-3-配置ip-forward转发"><a href="#1-1-3-配置ip-forward转发" class="headerlink" title="1.1.3 配置ip_forward转发"></a>1.1.3 配置ip_forward转发</h3><p>ip_forward 配置文件当前内容为0，表示禁止数据包转发，将其修改为1表示允许</p>
<p>echo “1” &gt; /proc/sys/net/ipv4/ip_forward </p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvihwb0tj30n200ywem.jpg" alt></p>
<h3 id="1-1-4-更新yum源"><a href="#1-1-4-更新yum源" class="headerlink" title="1.1.4 更新yum源"></a>1.1.4 更新yum源</h3><p>为了一次性配置好下载源，我们一次性修改好centos7软件源，docker源，k8s源</p>
<p>先清除掉系统自带配置</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvis58y4j30n208m7kk.jpg" alt="image-20200620171718159"> </p>
<p>下载centos7的源和docker源</p>
<p>wget -O /etc/yum.repos.d/CentOS-Base.repo <a href="http://mirrors.aliyun.com/repo/Centos-7.repo" target="_blank" rel="noopener">http://mirrors.aliyun.com/repo/Centos-7.repo</a></p>
<p>wget -P /etc/yum.repos.d/ <a href="http://mirrors.aliyun.com/repo/epel-7.repo" target="_blank" rel="noopener">http://mirrors.aliyun.com/repo/epel-7.repo</a> </p>
<p>wget <a href="https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo" target="_blank" rel="noopener">https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</a></p>
<p>结果如下：</p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvitlxcsj30n203qtdw.jpg" alt="image-20200620171725234"></p>
<p>配置k8s源</p>
<p>cat &lt;<eof> /etc/yum.repos.d/kubernetes.repo</eof></p>
<p>[kubernetes]</p>
<p>name=Kubernetes</p>
<p>baseurl=<a href="https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64" target="_blank" rel="noopener">https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64</a></p>
<p>enabled=1</p>
<p>gpgcheck=0</p>
<p>EOF</p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvj08i5hj30n206wdph.jpg" alt="image-20200620171733628"></p>
<p>刷新yum缓存</p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvj5bxivj30n207u11u.jpg" alt="image-20200620171742973"></p>
<h3 id="1-1-5-安装docker"><a href="#1-1-5-安装docker" class="headerlink" title="1.1.5 安装docker"></a>1.1.5 安装docker</h3><p>docker使用版本 18.09.9</p>
<p>yum install docker-ce-18.09.9 docker-ce-cli-18.09.9 containerd.io -y</p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvj83wunj30n2048jum.jpg" alt="image-20200620171750006"></p>
<p>k8s运行要求docker的–cgroup-driver=systemd</p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvjcgvr7j30n203kgps.jpg" alt="image-20200620171755853"></p>
<p>启动docker并设置开机启动</p>
<p>systemctl enable docker &amp;&amp;  systemctl start docker</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvjfcu1fj30n201wgoz.jpg" alt="image-20200620171801283"> </p>
<h3 id="1-1-6-安装k8s组件："><a href="#1-1-6-安装k8s组件：" class="headerlink" title="1.1.6 安装k8s组件："></a>1.1.6 安装k8s组件：</h3><p>yum install -y kubelet-1.16.4 kubeadm-1.16.4 kubectl-1.16.4</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvjm1douj30n2044af3.jpg" alt="image-20200620171810297"> </p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvjqm69uj30n203eq6w.jpg" alt="image-20200620171818555"></p>
<p>设置开机启动：systemctl enable kubelet &amp;&amp; systemctl start kubelet</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvjt4jonj30n200y40q.jpg" alt="image-20200620171823592"> </p>
<p>添加kubectl上下文到环境中</p>
<p>echo “source &lt;(kubectl completion bash)” &gt;&gt; ~/.bash_profile</p>
<p>source ~/.bash_profile</p>
<p>在家目录中，配置生效</p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvjy5g0jj30n201kq5c.jpg" alt="image-20200620171832144"></p>
<h3 id="1-1-7-内核参数修改"><a href="#1-1-7-内核参数修改" class="headerlink" title="1.1.7 内核参数修改"></a>1.1.7 内核参数修改</h3><p>k8s网络一般使用flannel，该网络需要设置内核参数bridge-nf-call-iptables=1</p>
<p>添加参数配置文件：</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvk431p7j30j402on15.jpg" alt="image-20200620171839612"> </p>
<p>执行：sysctl -p /etc/sysctl.d/k8s.conf</p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvk7trb6j30n202kn1m.jpg" alt="image-20200620171846335"></p>
<p>至此，环境准备工作完毕</p>
<h4 id="1-1-7-1内核参数修改失败常见问题"><a href="#1-1-7-1内核参数修改失败常见问题" class="headerlink" title="1.1.7.1内核参数修改失败常见问题"></a>1.1.7.1内核参数修改失败常见问题</h4><p>有些系统执行sysctl -p /etc/sysctl.d/k8s.conf会报异常，一般是因为</p>
<p>修改这个参数需要系统有br_netfilter模块</p>
<p>使用lsmod |grep br_netfilter命令，查看系统里是否有br_netfilter模块</p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvkd5ry2j30n2018gnt.jpg" alt="image-20200620171855653"></p>
<p><strong>新增br_netfilter</strong> <strong>模块:</strong></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvkjxhxnj30n2024jup.jpg" alt="image-20200620171906349"> </p>
<p><strong>上述方式重启后无效。需要配置系统启动加载脚本使其永久生效：</strong></p>
<p>Ø <strong>先加开机启动动作</strong></p>
<p><strong>vi /etc/rc.sysinit</strong></p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvmo0hxhj30jw04074w.jpg" alt></p>
<p>Ø <strong>再做加载模块动作</strong></p>
<p><strong>vi /etc/sysconfig/modules/br_netfilter.modules</strong></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvmunhggj30n201wdg2.jpg" alt> </p>
<p>Ø <strong>再增加执行权限</strong></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvn48zfjj30n201e74j.jpg" alt></p>
<h2 id="1-2-Master节点配置"><a href="#1-2-Master节点配置" class="headerlink" title="1.2 Master节点配置"></a>1.2 Master节点配置</h2><h3 id="1-2-1-Master节点初始化"><a href="#1-2-1-Master节点初始化" class="headerlink" title="1.2.1 Master节点初始化"></a>1.2.1 Master节点初始化</h3><p>kubeadm init –image-repository registry.aliyuncs.com/google_containers –kubernetes-version v1.16.4 –pod-network-cidr=10.244.0.0/16</p>
<p>这一步，如果出现下面错误，则是前面的2.1.6节点内核没有配置</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvndb9jsj30n201oaaj.jpg" alt> </p>
<p>正常情况，如下：</p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvnobl3vj30n202gjs0.jpg" alt></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvnser2qj30n207kgnf.jpg" alt> </p>
<p>出现这一步，恭喜你，已经成功一大半了！</p>
<p>接下来，我们按它的提示执行操作</p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvo10v5oj30n201gt8x.jpg" alt></p>
<h3 id="1-2-2-添加flannel的网络"><a href="#1-2-2-添加flannel的网络" class="headerlink" title="1.2.2 添加flannel的网络"></a>1.2.2 添加flannel的网络</h3><p>按照master的提示，我们接下来应该配置一个pod network。</p>
<p>但是，因为国内网络不通的原因，此操作无法完成。</p>
<p>你只能选择定制的文件来完成,下载地址: <a href="https://ellen566.cowtransfer.com/s/afff2c7b40f942" target="_blank" rel="noopener">https://ellen566.cowtransfer.com/s/afff2c7b40f942</a> 取件码：54b6hk</p>
<p>上传文件到你的系统后，使用下面命令</p>
<p>kubectl apply -f flannel.yml </p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvo8cw0xj30n206u76e.jpg" alt></p>
<p>至此，大功告成</p>
<h3 id="1-2-3-查看集群"><a href="#1-2-3-查看集群" class="headerlink" title="1.2.3 查看集群"></a>1.2.3 查看集群</h3><p>查看你k8s集群</p>
<p> <img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvoetaxaj30n2028jrr.jpg" alt></p>
<h2 id="1-3-work节点初始化"><a href="#1-3-work节点初始化" class="headerlink" title="1.3 work节点初始化"></a>1.3 work节点初始化</h2><p><strong>work</strong> <strong>节点的配置，相对master</strong> <strong>来说简单许多，只需要规划好节点的名称即可</strong></p>
<h3 id="1-3-1-设置机器名"><a href="#1-3-1-设置机器名" class="headerlink" title="1.3.1 设置机器名"></a>1.3.1 设置机器名</h3><p>设置一个机器名为work1</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvoj5yjkj30ki01cq32.jpg" alt> </p>
<p>配置对应的ip</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvop2fj3j30n202w74y.jpg" alt> </p>
<h3 id="1-3-2-加入集群"><a href="#1-3-2-加入集群" class="headerlink" title="1.3.2 加入集群"></a>1.3.2 加入集群</h3><p>在要加入的工作节点机器上，执行master 初始化时提示的join语句，即加到master的管辖内</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvoudgkrj30n204s75b.jpg" alt> </p>
<p><strong>回到master</strong> <strong>节点再次查看集群</strong></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gfyvoyyhiaj30n202674l.jpg" alt></p>

        </div>
        <div id="post-footer">
            <div class="avatar">
                <img src="http://ww1.sinaimg.cn/large/006tNc79ly1g4jcpbkpo7j30u01407wj.jpg" alt="avatar">
                
                
                <a href="javascript:void(0)" class="donate fa">赠我一杯 &#128536;</a>
                
            </div>
            <ul class="author-profile-section">
                <li>
                  
                  Author:
                  
                    
                    <a href="/about.html">lill</a>
                </li>
                
                <li>Published Date: <span>2020-06-20  17:09:21</span></li>
                
                <li>Updated Date: <span>2020-06-20  17:33:10</span></li>
                
                <li class="post-category">
                    Categories:
                    
                    <a href="/categories/物理部署/">物理部署</a>
                    
                </li>
                <li class="post-tags">
                    Tags:
                    
                    <a href="/tags/k8s/">k8s</a>
                    
                </li>
                
                <li> License: <a href="https://creativecommons.org/licenses/by-nc-nd/3.0/" target="_blank">
知识共享署名-非商业性使用-禁止演绎 3.0 未本地化版本许可协议（CC BY-NC-ND 3.0）
</a></li>
                
            </ul>
            <div id="donate-wrap">
                
                
                
                <img src="http://ww3.sinaimg.cn/large/006tNc79ly1g4j3v2hrrjj30a00fk750.jpg" alt="支付宝付款" class="donate-img">
                
                <img src="http://ww2.sinaimg.cn/large/006tNc79ly1g4jc3z12itj30h90no0tp.jpg" alt="微信付款" class="donate-img">
                
                
            </div>
        </div>
    </article>
    <div class="article-nav">
        
        <a href="/2020/06/27/k8s-3/" class="pre-post fa fa-caret-left">K8S基础操作</a>
        
        
        <a href="/2020/06/20/k8s-1/" class="next-post fa">Kubernetes 概述</a>
        
    </div>
    
    <div id="comments">
        

<script>
  gitment.render(document.getElementById("comments"));
</script>



    </div>
    
</div>


    </div>
    <footer id="footer">
    
    <div class="social">
        
        <a href="https://github.com/EllenJack/ellenjack.github.io.git" class="fa fa-free-code-camp" target="_blank" title="freecodecamp"></a>
        
        <a href="https://github.com/EllenJack/ellenjack.github.io.git" class="fa fa-github" target="_blank" title="Follow me~"></a>
        
    </div>
    
    <div>
        
        <a href="/" class="copyright-links">lill</a>&copy;2015 - 2022.All Rights
        Reserved.
    </div>
    <p>Powered by <a href="https://hexo.io" class="copyright-links" target="_blank">Hexo</a> | Theme by <a href="https://github.com/GeekaholicLin" class="copyright-links" target="_blank">GeekaholicLin</a>
    </p>
    
</footer>

</div>
    <ul id="tools">
    <li class="totop-btn fa fa-angle-up"></li>
    <li class="exchange-btn fa fa-exchange"></li>
  
    <li class="toc-btn fa fa-list-ul"></li>
    
    

    
</ul>
<p id="process"></p>
<div id="search-overlay">
    <div class="search-area-wrap">
        <div id="search-area">
            <div class="input-wrap focus">
                <i class="fa fa-search" aria-hidden="true"></i>
                <input id="search-input" autofocus autocomplete="off" type="text" placeholder="search this website...">
            </div>
            <ul id="search-result">
                <li class="load-first"><i class="fa fa-spinner fa-pulse"></i></li>
            </ul>
        </div>
    </div>
</div>

    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-环境准备"><span class="toc-number">1.</span> <span class="toc-text">1.1 环境准备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-1-关闭selinux"><span class="toc-number">1.1.</span> <span class="toc-text">1.1.1 关闭selinux</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-2-关闭swap"><span class="toc-number">1.2.</span> <span class="toc-text">1.1.2 关闭swap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-3-配置ip-forward转发"><span class="toc-number">1.3.</span> <span class="toc-text">1.1.3 配置ip_forward转发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-4-更新yum源"><span class="toc-number">1.4.</span> <span class="toc-text">1.1.4 更新yum源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-5-安装docker"><span class="toc-number">1.5.</span> <span class="toc-text">1.1.5 安装docker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-6-安装k8s组件："><span class="toc-number">1.6.</span> <span class="toc-text">1.1.6 安装k8s组件：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-7-内核参数修改"><span class="toc-number">1.7.</span> <span class="toc-text">1.1.7 内核参数修改</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-7-1内核参数修改失败常见问题"><span class="toc-number">1.7.1.</span> <span class="toc-text">1.1.7.1内核参数修改失败常见问题</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-Master节点配置"><span class="toc-number">2.</span> <span class="toc-text">1.2 Master节点配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-1-Master节点初始化"><span class="toc-number">2.1.</span> <span class="toc-text">1.2.1 Master节点初始化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-2-添加flannel的网络"><span class="toc-number">2.2.</span> <span class="toc-text">1.2.2 添加flannel的网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-3-查看集群"><span class="toc-number">2.3.</span> <span class="toc-text">1.2.3 查看集群</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-work节点初始化"><span class="toc-number">3.</span> <span class="toc-text">1.3 work节点初始化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-1-设置机器名"><span class="toc-number">3.1.</span> <span class="toc-text">1.3.1 设置机器名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-2-加入集群"><span class="toc-number">3.2.</span> <span class="toc-text">1.3.2 加入集群</span></a></li></ol></li></ol>




<script src="/js/search.js"></script>
<script type="text/javascript">
    //theme config datas
    var copyrightObj = {};
    copyrightObj.enable = 'true';
    copyrightObj.triggerCopyLength = '200';
    copyrightObj.appendText = '商业转载请联系作者获得授权,非商业转载请注明出处 © example';
    var leancloudObj = {};
    leancloudObj.enable = 'false';
    leancloudObj.className = 'BlogCounter';
    leancloudObj.limits = '10';
</script>
<script type="text/javascript">
    var search = {};
    var search_path = "search.xml";
    if (!search_path) {
        search_path = "search.xml";
    }
    search.path = "/" + search_path;
    search.func =  _ajax.init();
</script>
<script src="/js/app.js"></script>


</body>
</html>